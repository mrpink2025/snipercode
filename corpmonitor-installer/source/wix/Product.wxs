<?xml version="1.0" encoding="UTF-8"?>
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi">
  
  <!-- ===== PLACEHOLDERS - PREENCHER ANTES DO BUILD ===== -->
  <?define ProductName = "CorpMonitor Web Protection" ?>
  <?define ProductVersion = "1.0.1" ?>
  <?define Manufacturer = "[PREENCHER_NOME_EMPRESA]" ?>
  <?define ExtensionId = "[PREENCHER_EXTENSION_ID]" ?>
  <?define UpgradeCode = "[PREENCHER_GUID_UPGRADE]" ?>
  
  <Product 
    Id="*" 
    Name="$(var.ProductName)" 
    Language="1033" 
    Version="$(var.ProductVersion)" 
    Manufacturer="$(var.Manufacturer)" 
    UpgradeCode="$(var.UpgradeCode)">
    
    <Package 
      InstallerVersion="500" 
      Compressed="yes" 
      InstallScope="perMachine" 
      Platform="x64"
      SummaryCodepage="1252"
      Description="CorpMonitor Chrome Extension - Enterprise Security Monitor"
      Comments="Installs CorpMonitor extension for all Chrome users"
      Manufacturer="$(var.Manufacturer)" />
    
    <!-- Suporte a major upgrades -->
    <MajorUpgrade 
      DowngradeErrorMessage="A newer version of [ProductName] is already installed." 
      AllowSameVersionUpgrades="yes" />
    
    <!-- URLs do produto -->
    <Property Id="ARPHELPLINK" Value="https://monitorcorporativo.com/support" />
    <Property Id="ARPURLINFOABOUT" Value="https://monitorcorporativo.com" />
    
    <!-- Propriedades customizadas -->
    <Property Id="WIXUI_INSTALLDIR" Value="INSTALLFOLDER" />
    
    <!-- CBCM (Chrome Browser Cloud Management) -->
    <Property Id="CHROME_ENROLLMENT_TOKEN" Secure="yes" Value="[PREENCHER_CBCM_TOKEN]" />
    <Property Id="CHROME_ENROLLMENT_MANDATORY" Value="1" />
    
    <!-- CBCM token required -->
    <Condition Message="CBCM Enrollment Token is required. Install with: msiexec /i CorpMonitor.msi CHROME_ENROLLMENT_TOKEN=&quot;your_token&quot;">
      <![CDATA[CHROME_ENROLLMENT_TOKEN <> ""]]>
    </Condition>

    <!-- Condições de instalação -->
    <Condition Message="This application requires Windows 7 or later.">
      <![CDATA[Installed OR VersionNT >= 601]]>
    </Condition>
    
    <!-- Media (arquivos compactados no MSI) -->
    <MediaTemplate EmbedCab="yes" />
    
    <!-- Estrutura de diretórios (obrigatória pelo WiX) -->
    <Directory Id="TARGETDIR" Name="SourceDir">
      <Directory Id="ProgramFiles64Folder">
        <Directory Id="INSTALLFOLDER" Name="CorpMonitor" />
      </Directory>
    </Directory>
    
    <!-- Features (componentes instaláveis) -->
    <Feature Id="ProductFeature" Title="CorpMonitor Extension" Level="1">
      <ComponentGroupRef Id="CBCMKeys_x64" />
      <ComponentGroupRef Id="CBCMKeys_x86" />
    </Feature>
    
    <!-- UI (interface customizada) -->
    <UIRef Id="CorpMonitorUI" />
    
  </Product>
</Wix>
